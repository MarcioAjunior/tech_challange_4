(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4221:(e,t,r)=>{Promise.resolve().then(r.bind(r,8224)),Promise.resolve().then(r.bind(r,8998))},8224:(e,t,r)=>{"use strict";r.d(t,{default:()=>b});var a=r(5155),i=r(2115),o=r(8998),s=r(5417),n=r(6854),l=r(810),d=r(8562),c=r(6472),u=r(5781);u.t1.register(u.PP,u.kc,u.FN,u.No,u.hE,u.m_,u.s$);let h=e=>{let{data:t}=e,r=t.historico?t.historico.filter(e=>"1"===e.tipo):[],i=t.historico?t.historico.filter(e=>"2"===e.tipo):[],o=Array.from(new Set([...[...r.map(e=>e.data)].sort((e,t)=>new Date(e).getTime()-new Date(t).getTime()),...[...i.map(e=>e.data)].sort((e,t)=>new Date(e).getTime()-new Date(t).getTime())])),s={labels:o,datasets:[{label:"Valores fechados",data:o.map(e=>{var t;return(null===(t=r.find(t=>t.data===e))||void 0===t?void 0:t.valor)||null}),borderColor:"green",tension:.1,backgroundColor:"rgba(0, 0, 255, 0.1)",fill:!0},{label:"Valores previstos",data:o.map(e=>{var t;return(null===(t=i.find(t=>t.data===e))||void 0===t?void 0:t.valor)||null}),borderColor:"orange",tension:.1,backgroundColor:"rgba(0, 255, 0, 0.1)",fill:!0}]};return(0,a.jsx)(c.N1,{data:s,options:{responsive:!0,scales:{x:{title:{display:!0,text:"Data"}},y:{title:{display:!0,text:"Valor"}}}}})};var x=r(44),f=r(3455),m=r(8272),v=r(7166);let p=e=>{let{value:t,onChange:r}=e;return(0,a.jsx)(x.$,{dateAdapter:f.h,children:(0,a.jsx)(m.l,{label:"Selecione uma Data",value:t,onChange:r,renderInput:e=>(0,a.jsx)(v.A,{...e})})})},b=()=>{var e,t,r,c,u;let[x,f]=(0,i.useState)({historico:[],projecao:[]}),[m,v]=(0,i.useState)({mse:"",data_drift:{ks_statistic:"",p_value:"",drift_detected:!1},avg_time_inference:""}),[b,j]=(0,i.useState)(new Date),[y,g]=(0,i.useState)(!1),A=!1;(0,i.useEffect)(()=>{(async()=>{try{g(!0);let e=await fetch("/api/metrics");if(!e.ok)throw Error("Erro ao buscar m\xe9tricas");let t=await e.json();v(t)}catch(e){console.error("Erro ao buscar m\xe9tricas:",e)}finally{g(!1)}})()},[]);let D=async e=>{try{let t=await fetch("/api/predict",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:e})});if(!t.ok)throw Error("Erro ao buscar dados do endpoint");return await t.json()}catch(e){throw console.error("Erro ao buscar chartData:",e),e}},_=async e=>{if(!A){A=!0,g(!0);try{let t=await D(e);if(!t){console.error("chartData \xe9 null ou undefined");return}Array.isArray(t.result)?f({historico:t.result,projecao:[]}):t.detail?alert("Erro: ".concat(t.detail)):console.warn("Formato inesperado em chartData:",t)}catch(e){console.error("Erro ao buscar os dados:",e)}finally{g(!1),A=!1}}};return(0,i.useEffect)(()=>{b&&_(b.toISOString().split("T")[0])},[b]),(0,a.jsx)(o.default,{sx:{p:3,background:"#D3D3D3"},children:(0,a.jsxs)(s.Ay,{container:!0,spacing:3,children:[(0,a.jsx)(s.Ay,{item:!0,xs:12,md:7,children:y?(0,a.jsx)(n.A,{}):(0,a.jsx)(h,{data:x})}),(0,a.jsxs)(s.Ay,{item:!0,xs:12,md:5,children:[(0,a.jsx)(l.A,{variant:"h6",mb:2,children:"Sele\xe7\xe3o de Data"}),(0,a.jsx)(p,{value:b,onChange:j}),(0,a.jsxs)(s.Ay,{container:!0,spacing:2,mt:3,children:[(0,a.jsx)(s.Ay,{item:!0,xs:12,sm:4,children:(0,a.jsxs)(d.A,{sx:{p:2,display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,a.jsx)(l.A,{variant:"subtitle1",gutterBottom:!0,sx:{fontWeight:"bold"},children:"MSE"}),(0,a.jsx)(l.A,{variant:"body2",sx:{fontSize:"0.75rem"},children:null!==(t=null==m?void 0:m.mse)&&void 0!==t?t:""})]})}),(0,a.jsx)(s.Ay,{item:!0,xs:12,sm:4,children:(0,a.jsxs)(d.A,{sx:{p:2,display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,a.jsx)(l.A,{variant:"subtitle1",gutterBottom:!0,sx:{fontWeight:"bold"},children:"DATA DRIFT"}),(0,a.jsx)(l.A,{variant:"body2",sx:{fontSize:"0.75rem"},children:null!==(r=null==m?void 0:m.data_drift.ks_statistic)&&void 0!==r?r:""}),(0,a.jsx)(l.A,{variant:"body2",sx:{fontSize:"0.75rem"},children:null!==(c=null==m?void 0:m.data_drift.p_value)&&void 0!==c?c:""}),(0,a.jsx)(l.A,{variant:"body2",sx:{fontSize:"0.75rem"},children:(null==m?void 0:null===(e=m.data_drift)||void 0===e?void 0:e.drift_detected)?"Drift detectado":"Nenhum drift detectado"})]})}),(0,a.jsx)(s.Ay,{item:!0,xs:12,sm:4,children:(0,a.jsxs)(d.A,{sx:{p:2,display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,a.jsx)(l.A,{variant:"subtitle1",gutterBottom:!0,textAlign:"center",sx:{fontWeight:"bold"},children:"TEMPO M\xc9DIO DE INFER\xcaNCIA"}),(0,a.jsx)(l.A,{variant:"body2",children:null!==(u=null==m?void 0:m.avg_time_inference)&&void 0!==u?u:""})]})})]})]})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[647,182,441,517,358],()=>t(4221)),_N_E=e.O()}]);